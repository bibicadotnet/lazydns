# lazydns example configuration file
#
# See full examples and documentation at:
# https://github.com/lazywalker/lazydns/tree/master/examples
# https://lazywalker.github.io/lazydns/docs/

# Log configuration
log:
  level: info
  format: text
  file:
    enabled: true
    path: /var/log/lazydns/lazydns.log
    rotation:
      type: size
      period: daily
      max_size: 10M
      max_files: 5

# Plugin execution flow
plugins:
  # Forward to upstream DNS servers
  - tag: forward
    type: forward
    args:
      concurrent: 3
      upstreams:
        - addr: "8.8.8.8:53"
        - addr: "1.1.1.1:53"
        - "https://8.8.8.8/dns-query"

  # Simple sequence that forwards all queries
  - tag: main_sequence
    type: sequence
    args:
      - exec: $forward
      - exec: accept

  # UDP server listening on :5356
  - tag: udp_server
    type: udp_server
    args:
      entry: main_sequence
      listen: ":5354"

  # TCP server listening on :5356
  - tag: tcp_server
    type: tcp_server
    args:
      entry: main_sequence
      listen: ":5354"
